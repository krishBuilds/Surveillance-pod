<!-- Caption Generation Page -->
<div class="row g-3">
    <!-- Left: Configuration -->
    <div class="col-md-3">
        <div class="card">
            <div class="card-body p-3">
                <h6 class="mb-3">Configuration</h6>
                
                <div class="mb-3">
                    <label class="form-label small">Video</label>
                    <select id="caption-video-select" class="form-select form-select-sm">
                        <option value="">Choose video...</option>
                    </select>
                </div>

                <div class="row g-2 mb-3">
                    <div class="col-6">
                        <label class="form-label small">FPS</label>
                        <input type="number" id="caption-fps" class="form-control form-control-sm" 
                               value="1.0" min="0.1" max="3.0" step="0.1">
                    </div>
                    <div class="col-6">
                        <label class="form-label small">Chunk (sec)</label>
                        <input type="number" id="chunk-size" class="form-control form-control-sm" 
                               value="60" min="30" max="180" step="10">
                    </div>
                </div>

                <div class="mb-3">
                    <label class="form-label small">Mode</label>
                    <select id="processing-mode" class="form-select form-select-sm">
                        <option value="sequential">Sequential</option>
                        <option value="overlapping">Overlapping</option>
                        <option value="keyframe">Key Frame</option>
                        <option value="adaptive">Adaptive</option>
                    </select>
                </div>

                <div class="mb-3">
                    <label class="form-label small">Prompt</label>
                    <textarea id="caption-prompt" class="form-control form-control-sm" rows="2">Generate a detailed surveillance caption describing all visible activities, people, objects, and events. Include specific timing for actions and movements.</textarea>
                </div>

                <!-- Video Preview -->
                <div id="caption-video-preview" class="video-container mb-3 hidden" style="height: 140px;">
                    <video id="caption-preview-player" class="video-player" controls></video>
                </div>

                <button id="generate-caption-btn" class="btn btn-primary btn-sm w-100 mb-2">
                    <i class="bi bi-play-circle me-1"></i>
                    Generate
                </button>

                <!-- Timeline button - hidden until captions are generated -->
                <button id="caption-page-timeline-btn" class="btn btn-outline-info btn-sm w-100 hidden" onclick="showTimeline()">
                    <i class="bi bi-clock-history me-1"></i>
                    Generate Timeline from Captions
                </button>
            </div>
        </div>
    </div>

    <!-- Right: Results -->
    <div class="col-md-9">
        <div class="card">
            <div class="card-body p-3">
                <!-- Progress -->
                <div id="processing-progress" class="hidden mb-3">
                    <div class="d-flex justify-content-between mb-1">
                        <small class="text-muted">Processing</small>
                        <small id="progress-percentage">0%</small>
                    </div>
                    <div class="progress" style="height: 4px;">
                        <div id="progress-fill" class="progress-bar" style="width: 0%"></div>
                    </div>
                </div>

                <!-- Video Preview -->
                <div id="video-preview" class="video-container mb-3 hidden">
                    <video id="video-player" class="video-player" controls></video>
                </div>

                <!-- Chunks Results -->
                <div id="caption-results" class="hidden">
                    <div class="d-flex justify-content-between align-items-center mb-2">
                        <h6 class="mb-0">Generated Chunks</h6>
                        <div>
                            <button class="btn btn-outline-primary btn-sm me-1" onclick="showTimeline()">
                                <i class="bi bi-clock-history"></i> Timeline
                            </button>
                            <button class="btn btn-outline-secondary btn-sm me-1" onclick="copyAllChunks()">
                                <i class="bi bi-clipboard"></i>
                            </button>
                            <button class="btn btn-outline-secondary btn-sm" onclick="downloadAllChunks()">
                                <i class="bi bi-download"></i>
                            </button>
                        </div>
                    </div>
                    
                    <div id="chunks-container" class="border rounded" style="max-height: 400px; overflow-y: auto;">
                        <!-- Individual chunks will be inserted here -->
                    </div>
                </div>

                <!-- Timeline View -->
                <div id="timeline-view" class="hidden">
                    <div class="d-flex justify-content-between align-items-center mb-2">
                        <h6 class="mb-0">
                            <i class="bi bi-clock-history me-2"></i>
                            Video Timeline
                        </h6>
                        <div>
                            <button class="btn btn-outline-secondary btn-sm" onclick="toggleTimelineView()">
                                <i class="bi bi-arrow-left"></i> Back
                            </button>
                        </div>
                    </div>

                    
                    <!-- Timeline Container -->
                    <div id="video-timeline-container" class="border rounded" style="max-height: 500px; overflow-y: auto;">
                        <!-- Timeline will be rendered here -->
                    </div>
                </div>

                <!-- Empty State -->
                <div id="empty-state" class="text-center py-4">
                    <i class="bi bi-film text-muted" style="font-size: 2rem;"></i>
                    <div class="text-muted small mt-2">Select a video to begin</div>
                </div>
            </div>
        </div>
    </div>
</div>